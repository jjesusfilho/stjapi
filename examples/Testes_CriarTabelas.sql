--Validar campos Json, identificando  qtde itens por processo e datatype

/*
Dúvida:
1. Ao agregar os assuntos do processo numa única linha, ver como será apresentado quando este for sigiloso
2. Identificar o que pode ser obrigatório ou não. Aqueles que identifiquei Nulo, já informei no script
3. Quando campo nulo, não identifiquei datatype, categorizei como Varchar(10) e indiquei "--*****" no scritp
*/

CREATE TABLE Processo (
    numeroRegistro BIGINT IDENTITY(1,1) PRIMARY KEY,
    numeroRegistroFormatado VARCHAR(25),
    codigoClasse INT,
	numeroProcessoClasse INT, --**************** VALIDAR  - CLASSE
	qtdVolumes INT,
    qtdApensos INT,
    dataRegistroProtocolo DATE,
    dataAutuacao DATE,
    justicaGratuita BIT,
    originario BIT,
    segredoJustica BIT,
    agravoSTF BIT,
    criminal BIT,
    criminalCorte BIT,
	prioridade VARCHAR(10) NULL, --*****
    codigoCompetencia INT,
    numeroUnico BIGINT,
	numeroUnicoFormatado VARCHAR(50),
    codigoClasseAnterior INT,--**************** VALIDAR - CLASSE
    numeroClasseAnterior INT,--**************** VALIDAR - CLASSE
	numeroRegistroVinculante VARCHAR(10) NULL, --*****
	codigoOrigem  VARCHAR(10), 
	tipo CHAR(1),
    processoFisico BIT,
    processoEletronico BIT,
    preferencial BIT,
    sigiloso BIT,
	nivelSigilo VARCHAR(10) NULL, --*****
	pais VARCHAR(100) NULL, --*****
	codigoDestino INT,
	codigoStatus INT,
	numerosConexo VARCHAR(10) NULL,
	nomeLocalOrigem VARCHAR(10) NULL,
	numeroOrigemProtocolo VARCHAR(50),
	observacaoProcesso VARCHAR(MAX) NULL,
	pedidoLiminar BIT, 
	recolheuCusta VARCHAR(10) NULL,
	nome VARCHAR(255),
    nomeCompleto VARCHAR(255),
    nomeUf VARCHAR(50),
    uf VARCHAR(2),
	parteAutora VARCHAR(255),
	tipoParteAutora VARCHAR(50),
	parteRe VARCHAR(255),
	tipoParteRe VARCHAR(50),
	ministro VARCHAR(10) NULL, --*****
	codigoAssuntoCNJ INT, --***** SERIA O ASSUNTO PRINCIPAL --VALIDAR
	local VARCHAR(10) NULL, --*****
	documentos VARCHAR(10) NULL, --*****
	representativoControversia BIT,
	repetitivo BIT,
	valorCausa VARCHAR(10) NULL, --*****
	dataSituacao date 
);

CREATE TABLE TipoDocumentoDecisao (
    codigo INT PRIMARY KEY,
    descricao VARCHAR(255) NULL --TEM VALOR NULO 
);

CREATE TABLE Decisao (
    codigo BIGINT PRIMARY KEY,
    numeroPeticao BIGINT NULL,
    tipoDespacho VARCHAR(10) NULL, --*****
	codigoTipoDocumento INT FOREIGN KEY REFERENCES TipoDocumentoDecisao(codigo) ,
    ministro VARCHAR(255) NULL,
    dataConfirmacaoPublicacao DATETIME,
    nome VARCHAR(255) NULL,
    seqInteiroTeor BIGINT NULL,
    julgamentoEletronico BIT,
    indTipoEditor VARCHAR(50) NULL,
    decisao BIT 
);

CREATE TABLE ProcessoDecisao (
    numeroRegistro BIGINT FOREIGN KEY REFERENCES Processo(numeroRegistro),
    codigoDecisao BIGINT FOREIGN KEY REFERENCES Decisao(codigo)
);

CREATE TABLE Peticoes (
    numero BIGINT PRIMARY KEY,
    dataProtocolo DATETIME,
    descTipoPeticao VARCHAR(255),
    partePeticionante VARCHAR(255),
    status VARCHAR(500)
);

CREATE TABLE ProcessoPeticoes (
    numeroRegistro BIGINT FOREIGN KEY REFERENCES Processo(numeroRegistro),
    numeropeticao BIGINT FOREIGN KEY REFERENCES Peticoes(numero)
);

--REVER ESTRUTURA E TABELAS RELACIONADAS A PARTE
--(UMA PARTE (CPF) PODE TER TIPO DIFERENTE EM PROCESSOS
--TALVEZ CRIAR TABELA COM TIPO PARTE
--VALIDAR 

CREATE TABLE Partes (
    siglaTipoParte VARCHAR(50) NULL,
    indicadorAutorReu CHAR(1) NULL,
	codigoTipoParte VARCHAR(10) NULL,
	codigoOAB VARCHAR(10) NULL,
    nome VARCHAR(255) NOT NULL,
    cpfCnpj VARCHAR(20) UNIQUE,
    codigo INT PRIMARY KEY,
	seqParteProcesso BIGINT, --***** SÓ APARECE QUANDO TIPO PARTE
	tipo VARCHAR(10), 
	codTipoEnte VARCHAR(10) NULL,
	descricaoTipoParte VARCHAR(255) NULL,
	numeroOrdemParte INT,
    descricaoTipoParteFem VARCHAR(255) NULL,
	sexoParte CHAR(1) NULL  
);

CREATE TABLE ProcessoPartes (
	numeroRegistro BIGINT FOREIGN KEY REFERENCES Processo(numeroRegistro),
	codigoParte INT FOREIGN KEY REFERENCES Partes(codigo)
);

CREATE TABLE Fases (
    codigo INT PRIMARY KEY,
    numeroRegistro BIGINT FOREIGN KEY REFERENCES Processo(numeroRegistro),
	dataHoraFase DATETIME,
    textoFase VARCHAR(MAX),
    descricaoSimplificada VARCHAR(MAX) --TEM VALOR BRANCO AO INVÉS DE NULO
);

CREATE TABLE Local (
    codigoLocal INT PRIMARY KEY, 
	nomeLocal VARCHAR(255) NOT NULL
);

CREATE TABLE LocalProcesso (
    numeroRegistro BIGINT IDENTITY (1,1) FOREIGN KEY REFERENCES Processo(numeroRegistro),
	codigoLocal INT NOT NULL
);

CREATE TABLE Deslocamento (
    codigo BIGINT PRIMARY KEY, -- Identificador único do deslocamento
    numeroRegistro BIGINT FOREIGN KEY REFERENCES Processo(numeroRegistro),
	localEntradaSeq INT FOREIGN KEY REFERENCES Local(codigoLocal),
    localSaidaSeq INT FOREIGN KEY REFERENCES Local(codigoLocal),
    dataEntrada DATETIME2 NOT NULL,
    dataSaida DATETIME2 NOT NULL
);

CREATE TABLE ProcessoFavorito (
    numeroRegistro BIGINT IDENTITY (1,1) FOREIGN KEY REFERENCES Processo(numeroRegistro),
	numeroRegistroFavorito INT NOT NULL,
	seqProcessoFavorito int NOT NULL
);

CREATE TABLE MinistroRelatorProcesso (
    numeroRegistro BIGINT IDENTITY (1,1) FOREIGN KEY REFERENCES Processo(numeroRegistro),
	numMinistro INT NOT NULL
);

CREATE TABLE MinistroRelator (
    numMinistro INT PRIMARY KEY,
    nomeMinistro VARCHAR(255) NOT NULL,
    sexoMinistro VARCHAR(1) NOT NULL,
    codigoTipoMinistro VARCHAR(10) NOT NULL
);

CREATE TABLE NumerosOrigemProcesso (
    numeroRegistro BIGINT IDENTITY (1,1) FOREIGN KEY REFERENCES Processo(numeroRegistro),
	numerosOrigem INT NOT NULL--DataType vai depender da formatação
	);

CREATE TABLE Classe (
    codigo INT PRIMARY KEY,
    sigla VARCHAR(10) NOT NULL,
	codigoClasseEmbargada INT NOT NULL,
	nome VARCHAR(255) NOT NULL   
);

CREATE TABLE Status (
    codigo INT PRIMARY KEY,
    descricao VARCHAR(50) NOT NULL,
	tramitando BIT NOT NULL 
);

CREATE TABLE Destino (
    codigo INT PRIMARY KEY,
    descricao VARCHAR(255) NOT NULL    
);

CREATE TABLE AssuntoProcesso (
    numeroRegistro BIGINT IDENTITY (1,1) FOREIGN KEY REFERENCES Processo(numeroRegistro),
	codigo INT NOT NULL,
	codigoAreaEspecializacao INT NOT NULL --se codigo assunto NÃO se repetir por area ELIMINAR daqui
);

CREATE TABLE Assunto (
    codigo INT PRIMARY KEY,
	descAssunto VARCHAR(255) NOT NULL,
	descricao VARCHAR(255) NULL, --*****
	descricaoCompleta VARCHAR(MAX) NOT NULL,
    codigoAreaEspecializacao INT,
	nomeAreaEspecializacao VARCHAR(50) NOT NULL,
	segredoJustica BIT NOT NULL --Há assuntos como segredo justiça
	);
	
CREATE TABLE Origem (
    codigo VARCHAR(10) PRIMARY KEY,
    nome VARCHAR(255) NOT NULL,
    sigla VARCHAR(10) NOT NULL
);

CREATE TABLE OrgaoJulgadorProcesso (
    numeroRegistro BIGINT IDENTITY (1,1) FOREIGN KEY REFERENCES Processo(numeroRegistro),
	codigo VARCHAR(10) NOT NULL
);


CREATE TABLE OrgaoJulgador (
    codigo VARCHAR(10) PRIMARY KEY, --*****
	nome VARCHAR(255) NOT NULL
);

CREATE TABLE OrgaoProcessanteProcesso (
    numeroRegistro BIGINT IDENTITY (1,1) FOREIGN KEY REFERENCES Processo(numeroRegistro),
	codigo VARCHAR(10) NOT NULL
);

CREATE TABLE OrgaoProcessante (
    codigo VARCHAR(10) PRIMARY KEY,
    nome VARCHAR(255) NOT NULL
);

CREATE TABLE formaDistribuicaoProcesso (
    numeroRegistro BIGINT IDENTITY (1,1) FOREIGN KEY REFERENCES Processo(numeroRegistro),
	codigo INT NOT NULL
);

CREATE TABLE formaDistribuicao (
    codigo INT PRIMARY KEY,
    descricao VARCHAR(255) NOT NULL
);

CREATE TABLE tipoDistribuicaoProcesso (
    numeroRegistro BIGINT IDENTITY (1,1) FOREIGN KEY REFERENCES Processo(numeroRegistro),
	codigo INT NOT NULL
);

CREATE TABLE tipoDistribuicao (
    codigo INT PRIMARY KEY,
    descricao VARCHAR(255) NOT NULL
);





